# Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ø¨Ú©â€ŒØ¢Ù¾ Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª

Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø¨Ú©â€ŒØ¢Ù¾ Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ø±ÙˆÚ˜Ù‡ CRM Ø±Ø§ ØªÙˆØ¶ÛŒØ­ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

## ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…

### ğŸ”„ Ø¨Ú©â€ŒØ¢Ù¾ Ø®ÙˆØ¯Ú©Ø§Ø±
- Ø¨Ú©â€ŒØ¢Ù¾ Ø±ÙˆØ²Ø§Ù†Ù‡ØŒ Ù‡ÙØªÚ¯ÛŒ ÛŒØ§ Ù…Ø§Ù‡Ø§Ù†Ù‡
- ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ú©â€ŒØ¢Ù¾ (gzip)
- Ø§Ø±Ø³Ø§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ø§ÛŒÙ…ÛŒÙ„
- Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø¯Øª Ù…Ø´Ø®Øµ
- Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ

### ğŸ“§ Ø³ÛŒØ³ØªÙ… Ø§ÛŒÙ…ÛŒÙ„
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Gmail SMTP
- Ø§Ø±Ø³Ø§Ù„ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ú©â€ŒØ¢Ù¾
- Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ¨Ø§ Ùˆ ÙØ§Ø±Ø³ÛŒ
- Ø¶Ù…ÛŒÙ…Ù‡ Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„ Ø¨Ú©â€ŒØ¢Ù¾

### âš™ï¸ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª
- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø±Ú©Ø²ÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³
- Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª
- Ù„Ø§Ú¯ ØªÙ…Ø§Ù… ØªØºÛŒÛŒØ±Ø§Øª
- Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª

## Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡

### 1. Ù†ØµØ¨ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§
```bash
npm install
```

### 2. Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
```bash
node scripts/setup-backup-system.js
```

### 3. ØªÙ†Ø¸ÛŒÙ… Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ÛŒØ·ÛŒ
ÙØ§ÛŒÙ„ `.env` Ø±Ø§ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†ÛŒØ¯:
```env
# Database
DATABASE_HOST=localhost
DATABASE_USER=root
DATABASE_PASSWORD=1234
DATABASE_NAME=crm_system

# Email
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password

# App URL
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 4. ØªØ³Øª Ø³ÛŒØ³ØªÙ…
```bash
node test-backup-complete.js
```

## Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ…

### ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ú©â€ŒØ¢Ù¾

#### Ø§Ø² Ø·Ø±ÛŒÙ‚ API:
```javascript
// Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ¹Ù„ÛŒ
const response = await fetch('/api/settings/backup/configure');
const { config } = await response.json();

// Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯
const newConfig = {
    enabled: true,
    schedule: 'daily', // daily, weekly, monthly
    time: '02:00',
    emailRecipients: ['admin@example.com'],
    retentionDays: 30,
    compression: true
};

await fetch('/api/settings/backup/configure', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(newConfig)
});
```

#### Ø§Ø² Ø·Ø±ÛŒÙ‚ Ú©Ø¯:
```javascript
import { settingsService } from '@/lib/settings-service';

// Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª
const config = await settingsService.getBackupConfig();

// Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
await settingsService.setBackupConfig({
    enabled: true,
    schedule: 'daily',
    time: '02:00',
    emailRecipients: ['admin@example.com'],
    retentionDays: 30,
    compression: true
});
```

### Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ú©â€ŒØ¢Ù¾ Ø¯Ø³ØªÛŒ

#### Ø§Ø² Ø·Ø±ÛŒÙ‚ API:
```javascript
const response = await fetch('/api/settings/backup/manual', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        emailRecipient: 'admin@example.com',
        includeEmail: true
    })
});

const result = await response.json();
console.log('Backup created:', result.backup);
```

#### Ø§Ø² Ø·Ø±ÛŒÙ‚ Ú©Ø¯:
```javascript
import { backupService } from '@/lib/backup';
import { emailService } from '@/lib/email-service';

// Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ú©â€ŒØ¢Ù¾
const result = await backupService.createBackup({
    compress: true,
    includeData: true,
    excludeTables: ['system_logs']
});

// Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„
if (result.success) {
    await emailService.sendBackupEmail(result, 'admin@example.com');
}
```

### ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„

```javascript
import { settingsService } from '@/lib/settings-service';

// ØªÙ†Ø¸ÛŒÙ… Ø§ÛŒÙ…ÛŒÙ„
await settingsService.setEmailConfig({
    enabled: true,
    smtp_host: 'smtp.gmail.com',
    smtp_port: 587,
    smtp_secure: true,
    smtp_user: 'your-email@gmail.com',
    smtp_password: 'your-app-password'
});
```

## API Endpoints

### Ø¨Ú©â€ŒØ¢Ù¾
- `GET /api/settings/backup/configure` - Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ú©â€ŒØ¢Ù¾
- `POST /api/settings/backup/configure` - Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ú©â€ŒØ¢Ù¾
- `POST /api/settings/backup/manual` - Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ú©â€ŒØ¢Ù¾ Ø¯Ø³ØªÛŒ
- `GET /api/settings/backup/history` - ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ú©â€ŒØ¢Ù¾â€ŒÙ‡Ø§
- `GET /api/settings/backup/download/[id]` - Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø¨Ú©â€ŒØ¢Ù¾

### Ø§ÛŒÙ…ÛŒÙ„
- `GET /api/settings/email/configure` - Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„
- `POST /api/settings/email/configure` - Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„
- `POST /api/settings/email/test` - ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„

### ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…
- `GET /api/settings/status` - ÙˆØ¶Ø¹ÛŒØª Ú©Ù„ÛŒ Ø³ÛŒØ³ØªÙ…

## Ø³Ø§Ø®ØªØ§Ø± ÙØ§ÛŒÙ„â€ŒÙ‡Ø§

```
lib/
â”œâ”€â”€ backup.ts              # Ø³Ø±ÙˆÛŒØ³ Ø¨Ú©â€ŒØ¢Ù¾
â”œâ”€â”€ backup-scheduler.ts    # Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ú©â€ŒØ¢Ù¾
â”œâ”€â”€ email-service.ts       # Ø³Ø±ÙˆÛŒØ³ Ø§ÛŒÙ…ÛŒÙ„
â””â”€â”€ settings-service.ts    # Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª

app/api/settings/
â”œâ”€â”€ backup/
â”‚   â”œâ”€â”€ configure/         # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ú©â€ŒØ¢Ù¾
â”‚   â”œâ”€â”€ manual/            # Ø¨Ú©â€ŒØ¢Ù¾ Ø¯Ø³ØªÛŒ
â”‚   â”œâ”€â”€ history/           # ØªØ§Ø±ÛŒØ®Ú†Ù‡
â”‚   â””â”€â”€ download/[id]/     # Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„
â””â”€â”€ email/
    â”œâ”€â”€ configure/         # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„
    â””â”€â”€ test/              # ØªØ³Øª Ø§ÛŒÙ…ÛŒÙ„

scripts/
â”œâ”€â”€ setup-backup-system.js # Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
â””â”€â”€ create-settings-tables.sql # Ø¬Ø¯Ø§ÙˆÙ„ Ø¯ÛŒØªØ§Ø¨ÛŒØ³

backups/                   # Ù¾ÙˆØ´Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ú©â€ŒØ¢Ù¾
```

## Ù†Ú©Ø§Øª Ù…Ù‡Ù…

### Ø§Ù…Ù†ÛŒØª
- ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ú©â€ŒØ¢Ù¾ Ø­Ø§ÙˆÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø³ Ù‡Ø³ØªÙ†Ø¯
- Ø±Ù…Ø²Ù‡Ø§ÛŒ Ø¹Ø¨ÙˆØ± Ø§ÛŒÙ…ÛŒÙ„ Ø±Ø§ Ø¯Ø± Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ÛŒØ·ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯
- Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ú©â€ŒØ¢Ù¾ Ø±Ø§ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ù†ÛŒØ¯

### Ø¹Ù…Ù„Ú©Ø±Ø¯
- ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ú©â€ŒØ¢Ù¾ Ø¨Ù‡ ØµÙˆØ±Øª ÙØ´Ø±Ø¯Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- Ø¬Ø¯Ø§ÙˆÙ„ Ù„Ø§Ú¯ Ø§Ø² Ø¨Ú©â€ŒØ¢Ù¾ Ø­Ø°Ù Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ ØªØ§ Ø­Ø¬Ù… Ú©Ù… Ø´ÙˆØ¯
- ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø­Ø°Ù Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

### Ù†Ø¸Ø§Ø±Øª
- ØªÙ…Ø§Ù… ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ `system_logs` Ø«Ø¨Øª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ú©â€ŒØ¢Ù¾â€ŒÙ‡Ø§ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ `backup_history` Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ù…ÙˆÙÙ‚ÛŒØª Ùˆ Ø®Ø·Ø§ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

## Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### Ù…Ø´Ú©Ù„Ø§Øª Ø±Ø§ÛŒØ¬

#### mysqldump Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª
```bash
# Ubuntu/Debian
sudo apt-get install mysql-client

# CentOS/RHEL
sudo yum install mysql

# macOS
brew install mysql-client
```

#### Ø®Ø·Ø§ÛŒ Ø§ÛŒÙ…ÛŒÙ„
- Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ Ú©Ù‡ App Password Ø¨Ø±Ø§ÛŒ Gmail ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
- Two-Factor Authentication Ø¨Ø§ÛŒØ¯ ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯
- ØªÙ†Ø¸ÛŒÙ…Ø§Øª SMTP Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯

#### Ù…Ø´Ú©Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ ÙØ§ÛŒÙ„
- Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒ Ù¾ÙˆØ´Ù‡ `backups` Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯
- ÙØ¶Ø§ÛŒ Ø¯ÛŒØ³Ú© Ú©Ø§ÙÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯

### Ù„Ø§Ú¯â€ŒÙ‡Ø§
```sql
-- Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…
SELECT * FROM system_logs 
WHERE log_type LIKE '%backup%' 
ORDER BY created_at DESC 
LIMIT 10;

-- Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ú©â€ŒØ¢Ù¾
SELECT * FROM backup_history 
ORDER BY created_at DESC 
LIMIT 10;
```

## Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ

Ø¨Ø±Ø§ÛŒ Ù…Ø´Ú©Ù„Ø§Øª Ùˆ Ø³ÙˆØ§Ù„Ø§Øª:
1. Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯
2. ÙØ§ÛŒÙ„ `test-backup-complete.js` Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
3. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„ Ùˆ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯